<!DOCTYPE html><html lang="en"><head><!-- hexo injector head_begin start --><link href="https://cdn.jsdelivr.net/npm/hexo-tag-common@latest/css/index.css" rel="stylesheet"/><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#7ccbab"><meta name="author" content="Long Yu"><meta name="copyright" content="Long Yu"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>Some Thoughts on SQL and LINQ | Long Yu's Space</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#7ccbab"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"reimirno.github.io","root":"/","title":["Long","Yu's","Space"],"version":"1.6.2","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"What is in your mind?","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","local_search":{"path":"/search.xml"},"fireworks":{"colors":["124, 203, 171","83, 161, 122","26, 77, 207","20, 115, 239"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css"><link rel="stylesheet" href="/css/admonition.css"><link rel="stylesheet" href="/css/iconstyle.css"><meta name="description" content="!!! error Construction OngoingThis is not a finished post. The final version may have drastic differences as compared to this draft.">
<meta property="og:type" content="article">
<meta property="og:title" content="Some Thoughts on SQL and LINQ">
<meta property="og:url" content="https://reimirno.github.io/2021/11/22/SQL-Collections/index.html">
<meta property="og:site_name" content="Long Yu&#39;s Space">
<meta property="og:description" content="!!! error Construction OngoingThis is not a finished post. The final version may have drastic differences as compared to this draft.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-11-22T17:42:24.000Z">
<meta property="article:modified_time" content="2021-12-08T19:20:15.498Z">
<meta property="article:author" content="Long Yu">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Long Yu"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Long Yu"><span class="site-author-status" title="Give me the least, if not the one!">🥰</span></a><div class="site-author-name"><a href="/about/">Long Yu</a></div><a class="site-name" href="/about/site.html">Long Yu's Space</a><sub class="site-subtitle">Where All is Well</sub><div class="site-desciption">How's a day in Gensokyo like?</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">39</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">9</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">36</span></a></div><a class="site-state-item hty-icon-button" href="/random.html" title="Random Page"><span class="site-state-item-icon"><i class="ri-gift-line ri-xl"></i></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1072625448&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/images/wechatQR.jpg" title="Wechat" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:johnsonlongyu@gmail.com?subject=Directed%20from%20Blog%20-%20Subject%3A%20" title="E-Mail" target="_blank" style="color:#e28743"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Reimirno" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.linkedin.com/in/yu-long/" title="LinkedIn" target="_blank" style="color:#0077b5"><i class="ri-linkedin-box-line ri-xl"></i></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=296076115" title="Netease Music" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/436096130" title="Bilibili" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/169714437/" title="Douban" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/Johnsonlongyu" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.facebook.com/profile.php?id=100014142698530" title="Facebook" target="_blank" style="color:#4267B2"><i class="ri-facebook-box-line ri-xl"></i></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.instagram.com/reimirno/" title="Instagram" target="_blank" style="color:#c52262"><i class="ri-instagram-line ri-xl"></i></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/compass/" title="Compass" style="color:#eb664b"><i class="ri-compass-line ri-xl"></i></a><a class="links-item hty-icon-button" href="/resume/" title="Resume" style="color:#7ef578"><i class="ri-profile-line ri-xl"></i></a><a class="links-item hty-icon-button" href="/works/" title="Works" style="color:#dc7aff"><i class="ri-briefcase-line ri-xl"></i></a><a class="links-item hty-icon-button" href="/links/" title="Friends" style="color:#78acff"><i class="ri-links-line ri-xl"></i></a><a class="links-item hty-icon-button" href="/helps/" title="Help" style="color:#ffcf40"><i class="ri-question-line ri-xl"></i></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Declarative-Programming"><span class="toc-number">1.</span> <span class="toc-text">Declarative Programming</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Some-heads-up-on-SQL"><span class="toc-number">2.</span> <span class="toc-text">Some heads up on SQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Operations"><span class="toc-number">3.</span> <span class="toc-text">Basic Operations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LINQ-Equivalence"><span class="toc-number">4.</span> <span class="toc-text">LINQ Equivalence</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://reimirno.github.io/2021/11/22/SQL-Collections/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Long Yu"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Long Yu's Space"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Some Thoughts on SQL and LINQ</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2021-11-22 17:42:24" itemprop="dateCreated datePublished" datetime="2021-11-22T17:42:24+00:00">2021-11-22</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2021-12-08 19:20:15" itemprop="dateModified" datetime="2021-12-08T19:20:15+00:00">2021-12-08</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">1.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="Reading time">8m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Technical/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Technical</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Technical/Notes/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Notes</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/C/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">C#</span></a><a class="tag-item" href="/tags/SQL/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">SQL</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#7ccbab;"><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css"><p>!!! error Construction Ongoing<br>This is not a finished post. The final version may have drastic differences as compared to this draft.</p>
<span id="more"></span>

<h2 id="Declarative-Programming"><a href="#Declarative-Programming" class="headerlink" title="Declarative Programming"></a>Declarative Programming</h2><p>It did not take me so long to realize the difference between high- and low-level languages (actually, it is not a clear dichotomy), but it does take a while for me to realize the distinction between declarative and imperative languages. I have been using both Markdown and C-like for a long time yet I failed to appreciate their intrinsic differences.</p>
<p>Declarative languages (Markdown, HTML, CSS SQL, Regex, Prolog…) focus on <em>WHAT</em> instead of <em>HOW</em>. They are the direct descriptions of the desired result, and the interpreter would figure out how to generate the result. They do not use control flow, and the order of evaluation is often not explicit. Everything is handled by the interpreter and the way (<em>HOW</em>) to retrieve the result is unpredictable, but it is sure that you would get the result.</p>
<p>In imperative languages (C-like, Python, Java, Scheme…), a program is a description of computational process. The interpreter would carry out the computation using a fixed set of evaluation rule and the <em>HOW</em> is predictable. In a way, it is less direct than declarative programs since it does not directly describe the result.</p>
<p>I was told that the dichotomy between declarative and imperative is not clear-cut, either. I am waiting for the day that I feel why this is so by my own heart.</p>
<h2 id="Some-heads-up-on-SQL"><a href="#Some-heads-up-on-SQL" class="headerlink" title="Some heads up on SQL"></a>Some heads up on SQL</h2><p>SQL stands for Structured Query Language. Essentially it is used to define, access, manipulate and query data within a database. Different databases should all support SQL which hAS an ANSI standard. However, different database companies try to come up with their own extended syntax beyond the standard ANSI SQL for market differentiation.</p>
<p>There are relational and nonrelational databases. The “relation” in “relational databases” essentially means that the data are organized in a tabular manner (rather than tree, graph or something else; such databases vanished FROM the modern industry).</p>
<p>In principle SQL keywords are not case-sensitive. However, in practice different companies of databases follow different standards. Capitalization may differ across operating systems, too. For now, we would use capitals for all SQL keywords and all lowercase letters for table/column names.</p>
<h2 id="Basic-Operations"><a href="#Basic-Operations" class="headerlink" title="Basic Operations"></a>Basic Operations</h2><p>!!! info Online Interpreter<br>Try this SQL <a target="_blank" rel="noopener" href="https://sql.js.org/examples/GUI/index.html">interpreter</a>.<br>When it says “syntax error”, the first thing to check is whether you misses a semicolon.</p>
<ul>
<li>Table Update and Basic Select</li>
</ul>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- In general,</span>
<span class="token comment">-- SELECT &lt;columns> FROM &lt;table> WHERE &lt;condition> ORDER BY &lt;order></span>
<span class="token comment">-- &lt;column> defines what the columns in the result table contain</span>

<span class="token comment">-- Create a table by using both CREATE TABLE and SELECT</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> cities<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> cities <span class="token keyword">AS</span>
  <span class="token keyword">SELECT</span> <span class="token number">38</span> <span class="token keyword">AS</span> latitude<span class="token punctuation">,</span> <span class="token number">122</span> <span class="token keyword">AS</span> longitude<span class="token punctuation">,</span> <span class="token string">"Berkeley"</span> <span class="token keyword">AS</span> city <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token number">42</span><span class="token punctuation">,</span>             <span class="token number">71</span><span class="token punctuation">,</span>               <span class="token string">"Cambridge"</span>        <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token number">45</span><span class="token punctuation">,</span>             <span class="token number">93</span><span class="token punctuation">,</span>               <span class="token string">"Minneapolis"</span><span class="token punctuation">;</span>

<span class="token comment">-- Modify the table</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> cities <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">999</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">999</span><span class="token punctuation">,</span> <span class="token string">"Unknown Land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> cities <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">888</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">888</span><span class="token punctuation">,</span> <span class="token string">"Unknown Land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> cities <span class="token punctuation">(</span>latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">999</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- only two columns have values</span>

<span class="token comment">-- Update</span>
<span class="token keyword">UPDATE</span> cities <span class="token keyword">SET</span> latitude <span class="token operator">=</span> <span class="token number">999</span> <span class="token keyword">WHERE</span> city <span class="token operator">=</span> <span class="token string">"Unknown Land"</span><span class="token punctuation">;</span>

<span class="token comment">-- SELECT would Select some records from a table and project it to a new table</span>
<span class="token comment">-- But this table is not saved. Hence, you need CREATE TABLE to save it.</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> cities<span class="token punctuation">;</span> <span class="token comment">-- Simply select everything</span>
<span class="token keyword">SELECT</span> city<span class="token punctuation">,</span> longitude <span class="token keyword">FROM</span> cities <span class="token keyword">WHERE</span> latitude <span class="token operator">></span> <span class="token number">40</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> city<span class="token punctuation">,</span> longitude <span class="token operator">+</span> latitude <span class="token keyword">as</span> longlat <span class="token keyword">FROM</span> cities <span class="token keyword">WHERE</span> latitude <span class="token operator">></span> <span class="token number">40</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> longitude<span class="token punctuation">;</span>

<span class="token comment">-- Filter out repeats, filter out null values</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> city <span class="token keyword">FROM</span> cities <span class="token keyword">WHERE</span> city <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token comment">-- NULL values are not 0 or whitespace. It is the result of leaving a cell of the table blank</span>
<span class="token comment">-- Cannot apply comparing operators on NULL; you can only use IS NULL and IS NOT NULL</span>
<span class="token keyword">SELECT</span> city<span class="token punctuation">,</span> longitude <span class="token operator">-</span> latitude <span class="token keyword">AS</span> gap <span class="token keyword">FROM</span> cities <span class="token keyword">WHERE</span> gap <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">&lt;></span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">-- WHERE can access the gap variable defined earlier!</span>

<span class="token comment">-- Order by descending, and take only the first two</span>
<span class="token keyword">SELECT</span> city <span class="token keyword">FROM</span> cities <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> longitude <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- Delete some records from the table</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> cities <span class="token keyword">WHERE</span> latitude <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">OR</span> longitude <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">-- Deletes all records!</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> cities<span class="token punctuation">;</span>
<span class="token comment">-- Delete the whole table</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> cities<span class="token punctuation">;</span></code></pre>

<ul>
<li>Inner Join</li>
</ul>
<p>Inner Join of two tables is Cartesian product.</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> parents<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> parents <span class="token keyword">AS</span>
  <span class="token keyword">SELECT</span> <span class="token string">"abraham"</span> <span class="token keyword">AS</span> parent<span class="token punctuation">,</span> <span class="token string">"barack"</span> <span class="token keyword">AS</span> child <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"abraham"</span>          <span class="token punctuation">,</span> <span class="token string">"clinton"</span>         <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"delano"</span>           <span class="token punctuation">,</span> <span class="token string">"herbert"</span>         <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"fillmore"</span>         <span class="token punctuation">,</span> <span class="token string">"abraham"</span>         <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"fillmore"</span>         <span class="token punctuation">,</span> <span class="token string">"delano"</span>          <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"fillmore"</span>         <span class="token punctuation">,</span> <span class="token string">"grover"</span>          <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"eisenhower"</span>       <span class="token punctuation">,</span> <span class="token string">"fillmore"</span><span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> dogs<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> dogs <span class="token keyword">AS</span>
  <span class="token keyword">SELECT</span> <span class="token string">"abraham"</span> <span class="token keyword">AS</span> name<span class="token punctuation">,</span> <span class="token string">"long"</span> <span class="token keyword">AS</span> fur <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"barack"</span> <span class="token punctuation">,</span> <span class="token string">"short"</span> <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"clinton"</span> <span class="token punctuation">,</span> <span class="token string">"long"</span> <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"delano"</span> <span class="token punctuation">,</span> <span class="token string">"long"</span> <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"eisenhower"</span> <span class="token punctuation">,</span> <span class="token string">"short"</span> <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"fillmore"</span> <span class="token punctuation">,</span> <span class="token string">"curly"</span> <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"grover"</span> <span class="token punctuation">,</span> <span class="token string">"short"</span> <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"herbert"</span> <span class="token punctuation">,</span> <span class="token string">"curly"</span><span class="token punctuation">;</span>

<span class="token comment">-- single table manipulation</span>
<span class="token keyword">SELECT</span> child <span class="token keyword">FROM</span> parents <span class="token keyword">where</span> parent <span class="token operator">=</span> <span class="token string">"abraham"</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> parent <span class="token keyword">FROM</span> parents <span class="token keyword">where</span> parent <span class="token operator">></span> child<span class="token punctuation">;</span>

<span class="token comment">-- Join two table</span>
<span class="token comment">-- Permutes all combination of records from two tables and produces a four-column table</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> parents<span class="token punctuation">,</span> dogs
<span class="token comment">-- Gets a table about all dogs whose parent and fur are both known</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> parents<span class="token punctuation">,</span> dogs <span class="token keyword">WHERE</span> child <span class="token operator">=</span> name
<span class="token comment">-- Select all parents of curly-furred dogs (no ambiguity of column names)</span>
<span class="token keyword">SELECT</span> parent <span class="token keyword">FROM</span> parents<span class="token punctuation">,</span> dogs <span class="token keyword">WHERE</span> child <span class="token operator">=</span> name <span class="token operator">AND</span> fur <span class="token operator">=</span> <span class="token string">"curly"</span>

<span class="token comment">-- Recall: SELECT &lt;columns> FROM &lt;table> WHERE &lt;condition> ORDER BY &lt;order></span>
<span class="token comment">-- &lt;table> is a comma-separated list of table names with optional aliases</span>

<span class="token comment">-- Get all pairs of sibling dogs</span>
<span class="token comment">-- Use dot operator and alias to disambiguate</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> siblings <span class="token keyword">AS</span>
  <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>child <span class="token keyword">AS</span> firstSib<span class="token punctuation">,</span> b<span class="token punctuation">.</span>child <span class="token keyword">AS</span> secondSib
    <span class="token keyword">FROM</span> parents <span class="token keyword">AS</span> a<span class="token punctuation">,</span> parents <span class="token keyword">AS</span> b
    <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>parent <span class="token operator">=</span> b<span class="token punctuation">.</span>parent <span class="token operator">AND</span> a<span class="token punctuation">.</span>child <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>child<span class="token punctuation">;</span>

<span class="token comment">-- Select all siblings with the same fur</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>firstSib<span class="token punctuation">,</span> a<span class="token punctuation">.</span>secondSib
  <span class="token keyword">FROM</span> siblings <span class="token keyword">AS</span> a<span class="token punctuation">,</span> dogs <span class="token keyword">AS</span> b<span class="token punctuation">,</span> dogs <span class="token keyword">as</span> c
  <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>firstSib <span class="token operator">=</span> b<span class="token punctuation">.</span>name <span class="token operator">AND</span> a<span class="token punctuation">.</span>secondSib <span class="token operator">=</span> c<span class="token punctuation">.</span>name <span class="token operator">AND</span> b<span class="token punctuation">.</span>fur <span class="token operator">=</span> c<span class="token punctuation">.</span>fur<span class="token punctuation">;</span></code></pre>

<ul>
<li>Numeric and String Manipulation</li>
</ul>
<p>Here is SQLite’s <a target="_blank" rel="noopener" href="https://www.sqlite.org/syntax/expr.html">BNF for expression</a>.</p>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- &lt; &lt;= > >= &lt;> != = (`&lt;>` and `!=` both means inequality. Equality is `=` - only a single equal sign.)</span>
<span class="token comment">-- + - * / %</span>
<span class="token comment">-- NOT AND OR</span>
<span class="token comment">-- ROUND ABS POWER</span>
<span class="token comment">-- || SUBSTR INSTR</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> players<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> players <span class="token keyword">AS</span>
  <span class="token keyword">SELECT</span> <span class="token string">"Reimu"</span> <span class="token keyword">AS</span> player<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">AS</span> atk<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">AS</span> def<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">AS</span> lvl<span class="token punctuation">,</span> <span class="token string">"Human"</span> <span class="token keyword">AS</span> race <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"Marisa"</span><span class="token punctuation">,</span>          <span class="token number">3</span><span class="token punctuation">,</span>        <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token string">"Human"</span>         <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"Youmu"</span><span class="token punctuation">,</span>           <span class="token number">2</span><span class="token punctuation">,</span>        <span class="token number">4</span><span class="token punctuation">,</span>        <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token string">"Non-human"</span>     <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"Cirno"</span><span class="token punctuation">,</span>           <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token string">"Baka"</span>          <span class="token keyword">UNION</span>
  <span class="token keyword">SELECT</span> <span class="token string">"Sanae"</span><span class="token punctuation">,</span>           <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token number">4</span><span class="token punctuation">,</span>        <span class="token number">2</span><span class="token punctuation">,</span>        <span class="token string">"Non-human"</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> player<span class="token punctuation">,</span> atk <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> lvl <span class="token keyword">AS</span> total_atk<span class="token punctuation">,</span> def <span class="token operator">+</span> POWER<span class="token punctuation">(</span>lvl<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> total_def <span class="token keyword">FROM</span> players<span class="token punctuation">;</span>

<span class="token comment">-- IN can be used as a shorthand to OR</span>
<span class="token keyword">SELECT</span> player <span class="token keyword">FROM</span> players <span class="token keyword">WHERE</span> atk <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">-- same as atk = 1 OR atk = 3</span></code></pre>

<ul>
<li>Aggregation (Cross-row operation)</li>
</ul>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- SELECT &lt;columns> FROM &lt;table> WHERE &lt;condition> ORDER BY &lt;order> can only refer to one row</span>
<span class="token comment">-- We check one row and decides whether to keep it</span>

<span class="token comment">-- Aggregate functions check</span>
<span class="token comment">-- SUM, MAX, SUM, AVG</span>

<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>atk<span class="token punctuation">)</span> <span class="token keyword">as</span> max_raw_atk<span class="token punctuation">,</span> <span class="token function">MIN</span><span class="token punctuation">(</span>def<span class="token punctuation">)</span> <span class="token keyword">as</span> min_raw_def <span class="token keyword">FROM</span> players<span class="token punctuation">;</span>
<span class="token comment">-- The max and the min of course does not occur in the same row; but this works!</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>atk<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> atk<span class="token punctuation">)</span> <span class="token keyword">FROM</span> players<span class="token punctuation">;</span>
<span class="token comment">-- The aggregate functions also will select a row; sometimes they are meaningful</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>atk<span class="token punctuation">)</span><span class="token punctuation">,</span> player <span class="token keyword">FROM</span> players<span class="token punctuation">;</span> <span class="token comment">-- It tells you the player with max atk is Marisa</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>atk<span class="token punctuation">)</span><span class="token punctuation">,</span> player <span class="token keyword">FROM</span> players<span class="token punctuation">;</span> <span class="token comment">-- Which one? There are two mins</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>atk<span class="token punctuation">)</span><span class="token punctuation">,</span> player <span class="token keyword">FROM</span> players<span class="token punctuation">;</span> <span class="token comment">-- Does not make sense</span></code></pre>

<ul>
<li>Grouping</li>
</ul>
<pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- SELECT &lt;columns> FROM &lt;table> GROUP BY &lt;expressions> HAVING &lt;expressions></span>
<span class="token comment">-- GROUP BY allows grouping. Aggregate operators are performed on individual groups.</span>
<span class="token comment">-- HAVING is used to filter the groups.</span>

<span class="token keyword">SELECT</span> race<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>def<span class="token punctuation">)</span> <span class="token keyword">FROM</span> players <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> race<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> race<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> population <span class="token keyword">FROM</span> players <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> race <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">AVG</span><span class="token punctuation">(</span>atk<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> atk<span class="token operator">/</span>def<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> players <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> atk<span class="token operator">/</span>def <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">-- only wants groups that have more than 1 member</span>
<span class="token keyword">SELECT</span> def<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>atk <span class="token operator">-</span> def<span class="token punctuation">)</span> <span class="token keyword">FROM</span> players <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> def <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> atk<span class="token punctuation">;</span></code></pre>

<h2 id="LINQ-Equivalence"><a href="#LINQ-Equivalence" class="headerlink" title="LINQ Equivalence"></a>LINQ Equivalence</h2><p>Probably one of the most powerful tool in C# (and one of the important reasons why I prefer it over the purely OOP Java) is LINQ.</p>
<pre class="language-cs" data-language="cs"><code class="language-cs">&#x2F;&#x2F; Linq supports both method syntax and sql syntax
int[] scores &#x3D; new int[] &#123;1, 3, 5, 6, 98, 99, 101&#125;;
&#x2F;&#x2F; Usually we use var anyways
IEnumerable&lt;int&gt; greatScores &#x3D;
  FROM score in scores
  WHERE score &gt; 80
  SELECT score
&#x2F;&#x2F; This is the same as
var greatScores_alt &#x3D; scores.Where(x &#x3D;&gt; x &gt; 80);
&#x2F;&#x2F; Note that the previous lines are never evaluated until you use them
&#x2F;&#x2F; For example, toList() or foreach</code></pre>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Long Yu</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://reimirno.github.io/2021/11/22/SQL-Collections/" title="Some Thoughts on SQL and LINQ">https://reimirno.github.io/2021/11/22/SQL-Collections/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul><script>document.addEventListener('copy', function (event) {
  const clipboardData = event.clipboardData || window.clipboardData;
  if (!clipboardData) { return; }
  const text = window.getSelection().toString();
  if (text) {
    event.preventDefault();
    clipboardData.setData('text/plain', text + '\n\nPost author: Long Yu\nPost link: https://reimirno.github.io/2021/11/22/SQL-Collections/\nCopyright Notice: All articles in this blog are licensed under CC BY-NC-SA 4.0 unless otherwise stated.');
  }
});</script></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/11/23/Unity-2D-Collections/" rel="prev" title="Down to Unity 2D Stacks I - 2D Physics"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Down to Unity 2D Stacks I - 2D Physics</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/11/09/Some-Scheme-Reminders/" rel="next" title="Extra Parentheses in Scheme - A Reminder for OOP Programmers"><span class="post-nav-text">Extra Parentheses in Scheme - A Reminder for OOP Programmers</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>Say something?</span><br><a class="hty-button hty-button--raised" id="github-discussions" target="_blank" rel="noopener" href="https://github.com/Reimirno/reimirno.github.io/discussions/new">GitHub Discussions</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2021 – 2023 </span><a class="with-love" id="animate" href="/thanks/" title="Thank-you page"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></a><span class="author"> Long Yu</span></div><div class="live_time"><span>The blog has run for</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-07-31T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="Total Visitors"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="Total Views"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#7ccbab" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="What is in your mind?" value=""></div><div id="local-search-result"></div></div><script>const date = new Date();
const today = (date.getMonth() + 1) + "-" + date.getDate()
const mourn_days = ["4-4"]
if (mourn_days.includes(today)) {
  document.documentElement.style.filter = "grayscale(1)";
}</script></div><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/hexo-tag-common@latest/js/index.js"></script><!-- hexo injector body_end end --></body></html>